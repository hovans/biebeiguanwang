import{j as e,aI as y,bA as L,i as p,n as x,r as f,ar as W,T as b,B as w,ah as h,bW as k,bh as _,ao as U,a9 as B,bj as j,b_ as F,an as V,aG as A,b$ as K,c0 as O,c1 as v,c2 as C,c3 as M,bg as P,aj as $,F as H,bG as R,bl as I,bm as Q,bn as D,bU as E,bo as z}from"./vendor.7b4e3a5ce4ba.chunk.js";import{i as T,M as g,H as J,J as X,K as Z,N as ee,O as re,D as te,k as ae,P as ne,b as oe}from"./index.44dd358e3964.js";import{c as ie,a as S,b as le,F as G,e as ce}from"./formik.esm.cd9d2689e596.chunk.js";import{L as Y}from"./LoadingButton.5369edfcf7d1.chunk.js";import{M as se}from"./Masonry.c9eb672df525.chunk.js";const N=({data:r,rowSpacing:t,columnSpacing:n,classes:a,isLoading:l,isValueLoading:c})=>e(y,{container:!0,spacing:t!=null?t:2,className:a==null?void 0:a.rowContainer,children:r.map((s,o)=>e(y,{item:!0,xs:12,className:a==null?void 0:a.rowItem,children:l?e(L,{variant:"text",width:"100%"}):p(y,{container:!0,spacing:n!=null?n:2,className:a==null?void 0:a.columnContainer,children:[e(y,{item:!0,xs:6,className:a==null?void 0:a.columnItemKey,children:s.key}),e(y,{item:!0,xs:6,className:a==null?void 0:a.columnItemValue,children:c?e(L,{variant:"text",width:"100%"}):s.value})]})},o))}),de=()=>{const{t:r}=x(),{data:t,isLoading:n}=T(),a=f.useMemo(()=>{var l,c;return[{key:r("profile.account-info-card.table.email",{context:"key"}),value:r("profile.account-info-card.table.email",{context:"value",email:t==null?void 0:t.email})},{key:r("profile.account-info-card.table.plan_expired_at",{context:"key"}),value:r("profile.account-info-card.table.plan_expired_at",{context:"value",date:W.unix((l=t==null?void 0:t.expired_at)!=null?l:0).format("YYYY-MM-DD HH:mm")})},{key:r("profile.account-info-card.table.created_at",{context:"key"}),value:r("profile.account-info-card.table.created_at",{context:"value",date:W.unix((c=t==null?void 0:t.created_at)!=null?c:0).format("YYYY-MM-DD HH:mm")})}].map(s=>({key:e(b,{noWrap:!0,children:s.key}),value:e(b,{noWrap:!0,children:s.value})}))},[t,r]);return e(g,{title:r("profile.account-info-card.title"),children:e(N,{data:a,isValueLoading:n})})},pe=()=>{const{t:r}=x(),{data:t,isLoading:n}=T(),a=f.useMemo(()=>{var l,c,s,o;return[{key:r("profile.wallet-card.table.balance",{context:"key"}),value:r("profile.wallet-card.table.balance",{context:"value",value:(((l=t==null?void 0:t.balance)!=null?l:0)/100).toFixed(2),count:((c=t==null?void 0:t.balance)!=null?c:0)/100})},{key:r("profile.wallet-card.table.commission_balance",{context:"key"}),value:r("profile.wallet-card.table.commission_balance",{context:"value",value:(((s=t==null?void 0:t.commission_balance)!=null?s:0)/100).toFixed(2),count:((o=t==null?void 0:t.commission_balance)!=null?o:0)/100})}].map(i=>({key:e(b,{noWrap:!0,children:i.key}),value:e(b,{noWrap:!0,children:i.value})}))},[t,r]);return e(g,{title:r("profile.wallet-card.title"),children:e(N,{data:a,isValueLoading:n})})},ue={old_password:"",new_password:"",confirm_password:"",submit:null},me=()=>{const{t:r}=x(),t=J(),[n]=X(),a=f.useMemo(()=>ie({old_password:S().required(r("profile.change-password-card.form.old_password",{context:"required"}).toString()),new_password:S().required(r("profile.change-password-card.form.new_password",{context:"required"}).toString()).min(8,r("profile.change-password-card.form.new_password",{context:"min",count:8}).toString()),confirm_password:S().required(r("profile.change-password-card.form.confirm_password",{context:"required"}).toString()).oneOf([le("new_password")],r("profile.change-password-card.form.confirm_password",{context:"not_match"}).toString())}),[r]),l=f.useCallback(async(c,{setSubmitting:s,setStatus:o,setErrors:i})=>{try{await n(c).unwrap(),o({success:!0}),t(Z())}catch(u){const d=u;console.error("Error changing password",d),o({success:!1,message:d.message}),i(d.errors||{submit:d.message})}finally{s(!1)}},[n,t]);return e(g,{title:r("profile.change-password-card.title"),children:e(G,{initialValues:ue,validationSchema:a,onSubmit:l,children:({handleChange:c,handleBlur:s,handleSubmit:o,errors:i,touched:u,isSubmitting:d,values:m})=>e(w,{component:"form",onSubmit:o,children:p(h,{spacing:2,children:[e(k,{type:"password",id:"old_password-label",name:"old_password",label:r("profile.change-password-card.form.old_password",{context:"label"}),value:m.old_password,onChange:c,onBlur:s,error:!!(u.old_password&&i.old_password),helperText:u.old_password&&i.old_password,disabled:d,fullWidth:!0}),e(k,{type:"password",id:"new_password-label",name:"new_password",label:r("profile.change-password-card.form.new_password",{context:"label"}),value:m.new_password,onChange:c,onBlur:s,error:!!(u.new_password&&i.new_password),helperText:u.new_password&&i.new_password,disabled:d,autoComplete:"new-password",fullWidth:!0}),e(k,{type:"password",id:"confirm_password-label",name:"confirm_password",label:r("profile.change-password-card.form.confirm_password",{context:"label"}),value:m.confirm_password,onChange:c,onBlur:s,error:!!(u.confirm_password&&i.confirm_password),helperText:u.confirm_password&&i.confirm_password,disabled:d,autoComplete:"new-password",fullWidth:!0}),p(h,{direction:"row",justifyContent:"space-between",children:[e(w,{children:e(b,{variant:"caption",color:"error",noWrap:!0,children:i.submit})}),p(h,{direction:"row",justifyContent:"flex-end",spacing:2,children:[e(_,{type:"reset",variant:"outlined",disabled:d,children:r("profile.change-password-card.form.reset-button")}),e(_,{type:"submit",variant:"contained",disabled:d,children:d?e(U,{size:16}):r("profile.change-password-card.form.submit-button")})]})]})]})})})})},fe=()=>{const{t:r}=x(),{data:t,isLoading:n}=T(),[a]=ee(),{enqueueSnackbar:l}=B(),c=f.useMemo(()=>({remind_expire:(t==null?void 0:t.remind_expire)===1,remind_traffic:(t==null?void 0:t.remind_traffic)===1}),[t]),s=f.useCallback(async(o,{setSubmitting:i,setStatus:u,setErrors:d})=>{try{await a({remind_expire:o.remind_expire?1:0,remind_traffic:o.remind_traffic?1:0}).unwrap(),u({success:!0}),l(r("notice::update-user",{context:"success"}),{variant:"success"})}catch(m){u({success:!1}),d(m.errors||{submit:m.message})}finally{i(!1)}},[l,r]);return e(g,{title:r("profile.notification-card.title"),children:e(G,{initialValues:c,onSubmit:s,enableReinitialize:!0,children:({values:o,handleChange:i,handleSubmit:u,handleBlur:d,isSubmitting:m})=>e(w,{component:ce,onSubmit:u,children:p(h,{spacing:2,children:[e(j,{control:e(F,{}),name:"remind_expire",checked:o.remind_expire,disabled:n||m,onChange:i,onBlur:d,label:r("profile.notification-card.expired_notify",{context:"label"}),labelPlacement:"end",sx:{m:0}}),e(j,{control:e(F,{}),name:"remind_traffic",checked:o.remind_traffic,disabled:n||m,onChange:i,onBlur:d,label:r("profile.notification-card.traffic_notify",{context:"label"}),labelPlacement:"end",sx:{m:0}}),e(h,{direction:"row",justifyContent:"flex-end",children:e(Y,{variant:"contained",type:"submit",loading:n||m,children:r("profile.notification-card.save-button")})})]})})})})},q=2,be=()=>{const{t:r}=x(),{data:t}=re(),{data:n}=te(),{data:a}=ae(),l=f.useMemo(()=>V,[r]),[c,s]=A("telegram_card_init",{defaultValue:0}),[o,{inc:i,dec:u}]=K(c,{min:0,max:q});f.useEffect(()=>{s(o)},[o]);const d=f.useMemo(()=>()=>p(h,{direction:"row",spacing:1,mt:2,children:[e(_,{onClick:()=>i(),variant:"contained",disabled:o>=q,children:r("profile.telegram-card.next_step")}),e(_,{onClick:()=>u(),variant:"text",disabled:o<=0,children:r("profile.telegram-card.previous_step")})]}),[r,o]);return e(g,{title:r("profile.telegram-card.title"),children:p(O,{activeStep:o,orientation:"vertical",children:[p(v,{children:[e(C,{children:e(b,{variant:"subtitle1",children:r("profile.telegram-card.add_bot",{context:"label"})})}),p(M,{children:[e(w,{children:e(l,{i18nKey:"profile.telegram-card.add_bot",tOptions:{context:"content",name:t==null?void 0:t.username},children:e(P,{href:"https://t.me/".concat(t==null?void 0:t.username),target:"_blank"})})}),e(d,{})]})]}),p(v,{children:[e(C,{children:e(b,{variant:"subtitle1",children:r("profile.telegram-card.send_command",{context:"label"})})}),p(M,{children:[e(w,{children:e(l,{i18nKey:"profile.telegram-card.send_command",tOptions:{context:"content"},children:{command:"/bind ".concat(a==null?void 0:a.subscribe_url)}})}),e(d,{})]})]}),p(v,{children:[e(C,{children:e(b,{variant:"subtitle1",children:r("profile.telegram-card.add_to_group",{context:"label"})})}),p(M,{children:[e(w,{children:e(b,{children:e(l,{i18nKey:"profile.telegram-card.add_to_group",tOptions:{link:n==null?void 0:n.telegram_discuss_link,context:"content"},children:e(P,{href:n==null?void 0:n.telegram_discuss_link,target:"_blank",rel:"noreferrer"})})})}),e(d,{})]})]})]})})},he=()=>{const{t:r}=x(),[t,{setLeft:n,setRight:a}]=$(!1),{enqueueSnackbar:l}=B(),[c,{isLoading:s}]=ne(),o=f.useCallback(async()=>{try{await c().unwrap(),l(r("notice::reset-security",{context:"success"}),{variant:"success"})}catch(i){console.error(i),l(r("notice::reset-security",{context:"failed"}),{variant:"error"})}finally{n()}},[c,l,r,n]);return p(H,{children:[e(g,{title:r("profile.reset-subscription-card.title"),children:p(h,{spacing:2,children:[e(R,{severity:"warning",children:r("profile.reset-subscription-card.alert")}),e(_,{variant:"contained",color:"error",fullWidth:!0,onClick:a,children:r("profile.reset-subscription-card.button")})]})}),p(I,{open:t,onClose:n,"aria-labelledby":"form-dialog-title",children:[e(Q,{id:"form-dialog-title",children:r("profile.reset-subscription-card.dialog.title")}),e(D,{children:e(E,{children:r("profile.reset-subscription-card.dialog.content")})}),p(z,{children:[e(_,{onClick:n,color:"primary",children:r("profile.reset-subscription-card.dialog.cancel")}),e(Y,{onClick:o,color:"error",loading:s,children:r("profile.reset-subscription-card.dialog.confirm")})]})]})]})},we=()=>p(se,{spacing:2,columns:{xs:1,md:2,xl:3},children:[e(de,{}),e(pe,{}),e(me,{}),e(fe,{}),e(be,{}),e(he,{})]}),ve=()=>(oe("profile"),e(we,{}));export{ve as default};
