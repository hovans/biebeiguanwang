import{b8 as b,b9 as D,n as q,aa as E,j as e,F as M,a$ as x,l as y,B as v,i as n,aI as r,ah as p,ba as S,an as l,bb as I,bc as w,bd as R,be as z,bf as O,T as u,bg as $,m as C,bh as G,ao as K}from"./vendor.7b4e3a5ce4ba.chunk.js";import{A as V}from"./AuthWrapper.adfbe31c739d.chunk.js";import{F as H,c as N,a as k}from"./formik.esm.cd9d2689e596.chunk.js";import{u as U,a as J,I as Q,b as X}from"./index.44dd358e3964.js";import{A as Y}from"./AnimateButton.aacfc9f9450e.chunk.js";import"./hey-listen.es.3d38fef0dd76.chunk.js";const Z=()=>{const[c,t]=b.useState(!1),{isLoggedIn:A}=U(i=>i.auth),[B]=J(),L=D(),{t:o}=q("common",{keyPrefix:"login"}),[g,F]=b.useState(!1),W=()=>{F(!g)},_=i=>{i.preventDefault()},j=i=>{i.getModifierState("CapsLock")?t(!0):t(!1)},P=E();return e(M,{children:e(H,{initialValues:{email:"",password:"",submit:null},validationSchema:N().shape({email:k().email(o("email_invalid").toString()).max(255).required(o("email_required").toString()),password:k().max(255).required(o("password_required").toString())}),onSubmit:async(i,{setErrors:d,setStatus:s,setSubmitting:m})=>{try{m(!0),await B(i).unwrap().then(()=>{s({success:!0}),x.event("login",{category:"auth",label:"login",method:"email",success:!0,email:i.email}),P("/dashboard",{replace:!0})}).catch(a=>{s({success:!1}),d(y.isEmpty(a.errors)?{submit:a.message}:a.errors),x.event("login",{category:"auth",label:"login",method:"email",success:!1,error:a.message,email:i.email,values:i})}).finally(()=>{m(!1)})}catch(a){console.error(a),L.current&&(s({success:!1}),d(y.isEmpty(a.errors)?{submit:a.message}:a.errors),m(!1))}},children:({errors:i,handleBlur:d,handleChange:s,handleSubmit:m,isSubmitting:a,touched:h,values:f})=>e(v,{component:"form",noValidate:!0,onSubmit:m,children:n(r,{container:!0,spacing:3,children:[e(r,{item:!0,xs:12,children:n(p,{spacing:1,children:[e(S,{htmlFor:"email-login",children:e(l,{children:"login.email"})}),e(I,{id:"email-login",type:"email",value:f.email,name:"email",onBlur:d,onChange:s,placeholder:o("email_placeholder").toString(),fullWidth:!0,error:!!(h.email&&i.email)}),h.email&&i.email&&e(w,{error:!0,id:"standard-weight-helper-text-email-login",children:i.email})]})}),e(r,{item:!0,xs:12,children:n(p,{spacing:1,children:[e(S,{htmlFor:"password-login",children:e(l,{children:"login.password"})}),e(I,{fullWidth:!0,color:c?"warning":"primary",error:!!(h.password&&i.password),id:"-password-login",type:g?"text":"password",value:f.password,name:"password",onBlur:T=>{t(!1),d(T)},onKeyDown:j,onChange:s,endAdornment:e(R,{position:"end",children:e(Q,{"aria-label":"toggle password visibility",onClick:W,onMouseDown:_,edge:"end",color:"secondary",children:g?e(z,{}):e(O,{})})}),placeholder:o("password_placeholder").toString()}),c&&e(u,{variant:"caption",sx:{color:"warning.main"},id:"warning-helper-text-password-login",children:e(l,{ns:"notice",children:"capslock_on"})}),h.password&&i.password&&e(w,{error:!0,id:"standard-weight-helper-text-password-login",children:i.password})]})}),e(r,{item:!0,xs:12,sx:{mt:-1},children:n(p,{direction:"row",justifyContent:"space-between",alignItems:"center",spacing:2,children:[e(v,{}),e($,{variant:"h6",component:C,to:A?"/auth/forgot-password":"/forgot-password",color:"text.primary",children:o("forgot_password").toString()})]})}),i.submit&&e(r,{item:!0,xs:12,children:e(w,{error:!0,children:i.submit})}),e(r,{item:!0,xs:12,children:e(Y,{children:e(G,{disableElevation:!0,disabled:a,fullWidth:!0,size:"large",type:"submit",variant:"contained",color:"primary",children:a?e(K,{size:24}):e(l,{i18nKey:"login.submit",children:"Submit"})})})})]})})})})},oe=()=>{var c,t;return X("login"),e(V,{children:n(r,{container:!0,spacing:3,children:[n(r,{item:!0,xs:12,container:!0,justifyContent:"center",alignItems:"center",children:[n(u,{color:"red",fontSize:"25px",children:["永久官网: ",(c=window.config)==null?void 0:c.officialWebsite]}),n(u,{children:["当前可用: ",(t=window.config)==null?void 0:t.website]})]}),e(r,{item:!0,xs:12,children:n(p,{direction:"row",justifyContent:"space-between",alignItems:"baseline",sx:{mb:{xs:-.5,sm:.5}},children:[e(u,{variant:"h3",children:e(l,{children:"login.title"})}),e(u,{component:C,to:"/register",variant:"body1",sx:{textDecoration:"none"},color:"primary",children:e(l,{children:"login.go-register"})})]})}),e(r,{item:!0,xs:12,children:e(Z,{})})]})})};export{oe as default};
