import{bM as _,r as b,h as M,a3 as F,aj as O,l as p,i as d,F as C,j as e,B as w,T as f,bA as g,n as A,aa as I,ah as T,bh as S,bl as j,bm as B,bn as E,bo as L}from"./vendor.7b4e3a5ce4ba.chunk.js";import{c as R}from"./constate.es.00b696db87ce.chunk.js";import{P as x}from"./plan.853c03fa5fdd.chunk.js";import{p as $,g as Q,a as G,b as q,d as z,c as J}from"./Cancel.8a6379a610d8.chunk.js";import{p as K,M as D,k as U,m as V,b as W}from"./index.44dd358e3964.js";import{E as H}from"./index.es.c6a3932c2db9.chunk.js";import{M as X}from"./Masonry.c9eb672df525.chunk.js";const Y=()=>{const[n,{add:r,remove:s,reset:u}]=_([x.PERIOD,x.TRAFFIC]),[a,{add:o,remove:i,reset:t}]=_($),[c,h]=b.useState(""),v=M(),l=F(v.breakpoints.down("md")),[y,{set:P,toggle:N}]=O(!l);return{planType:n,addPlanType:r,removePlanType:s,resetPlanType:u,togglePlanType:m=>{n.has(m)?s(m):r(m)},keyword:c,setKeyword:h,drawerOpen:y,setDrawerOpen:P,toggleDrawer:N,paymentAllow:a,addPayment:o,removePayment:i,resetPayment:t,togglePayment:m=>{a.has(m)?i(m):o(m)}}},[Z,k]=R(Y),ee=()=>d(D,{title:e(g,{variant:"text",width:200}),children:[e(g,{variant:"rectangular",width:"100%",height:100}),e(g,{variant:"text",width:200}),e(g,{variant:"text",width:160}),e(g,{variant:"text",width:160}),e(g,{variant:"text",width:200})]}),ne=({product:n})=>{const{t:r}=A(),s=I(),[u,a]=b.useState(!1),{data:o}=U(),i=b.useMemo(()=>{const l=G(n);if(!l)return{price:0,mode:"null"};const y=r("subscription.buy.product-card.price-mode",{context:l}).toString();return{price:q(n,l),mode:y}},[]),t=l=>{l.preventDefault(),o!=null&&o.plan_id&&o.plan_id!==n.id?a(!0):s("/plan/buy/".concat(n.id))},c=()=>{a(!1),s("/plan/buy/".concat(n.id))},h=()=>{a(!1)},v=b.useMemo(()=>{try{return JSON.parse(n.content).map((y,P)=>d(T,{direction:"row",alignItems:"center",spacing:1,children:[y.support?e(z,{color:"success"}):e(J,{color:"error"}),e(f,{variant:"body2",color:"textPrimary",children:y.feature})]},P))}catch(l){return e(H,{children:n.content})}},[n.content]);return d(C,{children:[e(D,{title:n.name,secondary:e(f,{variant:"caption",color:"textSecondary",children:r("subscription.buy.product-card.price-mode",{context:i.mode,defaultValue:i.mode}).toString()}),children:d(T,{direction:"column",spacing:2,children:[e(f,{variant:"h3",component:"h2",color:"textPrimary",children:"￥ "+p.ceil(i.price/100,2).toFixed(2)}),e("div",{children:v}),e(S,{variant:"contained",color:"primary",href:"/plan/buy/".concat(n.id),onClick:t,children:r("subscription.buy.product-card.buy-button").toString()})]})}),d(j,{open:u,onClose:h,children:[e(B,{children:r("subscription.buy.product-card.confirm.title")}),e(E,{children:e(f,{children:r("subscription.buy.product-card.confirm.message")})}),d(L,{children:[e(S,{onClick:h,children:r("subscription.buy.product-card.confirm.cancel")}),e(S,{onClick:c,color:"primary",variant:"contained",children:r("subscription.buy.product-card.confirm.confirm")})]})]})]})},te=()=>{const{drawerOpen:n,keyword:r,planType:s,paymentAllow:u}=k(),{data:a,isLoading:o}=K(),i=b.useMemo(()=>(a==null?void 0:a.filter(t=>t.show===1).filter(t=>t.name.includes(r)||t.content.includes(r)).filter(t=>{if(s.has(x.PERIOD)||s.has(x.TRAFFIC)){const c=p.isNumber(t.month_price)||p.isNumber(t.year_price)||p.isNumber(t.quarter_price)||p.isNumber(t.half_year_price)||p.isNumber(t.two_year_price)||p.isNumber(t.three_year_price),h=p.isNumber(t.onetime_price);return c||h}return!1}).filter(t=>new Set(Array.from(Object.keys(Q(t))).filter(c=>u.has(c))).size>0))||[],[a,r,s,u]);return d(C,{children:[o||i.length!==0&&d(X,{spacing:2,columns:{xs:1,sm:n?1:2,md:n?2:3,lg:n?3:4},children:[o&&Array.from({length:6}).map((t,c)=>e(ee,{},c)),i.map(t=>e(ne,{product:t},t.id))]}),!o&&i.length===0&&e(w,{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",my:4,children:e(f,{component:"span",variant:"h4",color:"textSecondary",children:"No Product Found"})})]})},re=V()((n,{open:r})=>({root:{display:"flex",flexDirection:"row"},main:{width:"100%",[n.breakpoints.up("sm")]:{marginLeft:r?0:-280,transition:n.transitions.create("margin",{easing:n.transitions.easing.easeInOut,duration:n.transitions.duration.leavingScreen})}}})),ae=()=>{const{drawerOpen:n}=k(),{classes:r}=re({open:n});return d(C,{children:[e(w,{children:e(f,{sx:{color:"red",fontWeight:"bold"},children:"注意：一个账号只能购买一个套餐，购买相同套餐为续费，增加时长，重置日自动重置流量。续费不会马上重置流量。提前用完流量请购买流量重置包。当月未使用完流量不累计到下个月。"})}),e(w,{marginBottom:2}),e(w,{className:r.root,children:e(T,{component:"main",spacing:2,className:r.main,children:e(te,{})})})]})},he=()=>(W("buy-plan"),e(Z,{children:e(ae,{})}));export{he as default};
