import{bp as B,r as $,bq as Be,a9 as Ie,n as we,j as T,bd as Ce,br as Pe,b8 as $e,i as _e,F as We,bl as qe,bm as Ue,an as Ge,bn as Ke,a$ as Oe}from"./vendor.7b4e3a5ce4ba.chunk.js";import{f as De,d as pe,I as Ee}from"./index.44dd358e3964.js";var ne={},He=B&&B.__createBinding||(Object.create?function(o,s,h,d){d===void 0&&(d=h);var g=Object.getOwnPropertyDescriptor(s,h);(!g||("get"in g?!s.__esModule:g.writable||g.configurable))&&(g={enumerable:!0,get:function(){return s[h]}}),Object.defineProperty(o,d,g)}:function(o,s,h,d){d===void 0&&(d=h),o[d]=s[h]}),Qe=B&&B.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),Ze=B&&B.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var h in o)h!=="default"&&Object.prototype.hasOwnProperty.call(o,h)&&He(s,o,h);return Qe(s,o),s};Object.defineProperty(ne,"__esModule",{value:!0});ne.useTurnstile=void 0;const V=Ze($),Y=typeof globalThis<"u"?globalThis:window;let F=typeof Y.turnstile<"u"?"ready":"unloaded",xe,fe;const Ae=new Promise((o,s)=>{fe={resolve:o,reject:s},F==="ready"&&o(void 0)});{const o="cf__reactTurnstileOnLoad",s="https://challenges.cloudflare.com/turnstile/v0/api.js";xe=()=>{if(F==="unloaded"){F="loading",Y[o]=()=>{fe.resolve(),F="ready",delete Y[o]};const h="".concat(s,"?onload=").concat(o,"&render=explicit"),d=document.createElement("script");d.src=h,d.async=!0,d.addEventListener("error",()=>{fe.reject("Failed to load Turnstile."),delete Y[o]}),document.head.appendChild(d)}return Ae}}function Je({id:o,className:s,style:h,sitekey:d,action:g,cData:S,theme:C,language:x,tabIndex:b,responseField:N,responseFieldName:A,size:_,fixedSize:W,retry:q,retryInterval:z,refreshExpired:y,appearance:ee,execution:M,userRef:v,onVerify:j,onSuccess:U,onLoad:G,onError:K,onExpire:H,onTimeout:Q,onAfterInteractive:Z,onBeforeInteractive:P,onUnsupported:J}){const te=(0,V.useRef)(null),p=(0,V.useState)({onVerify:j,onSuccess:U,onLoad:G,onError:K,onExpire:H,onTimeout:Q,onAfterInteractive:Z,onBeforeInteractive:P,onUnsupported:J})[0],t=v!=null?v:te,u=W?{width:_==="compact"?"130px":_==="flexible"?"100%":"300px",height:_==="compact"?"120px":"65px",...h}:h;return(0,V.useEffect)(()=>{if(!t.current)return;let i=!1,e="";return(async()=>{var a,l;if(F!=="ready")try{await xe()}catch(r){(a=p.onError)===null||a===void 0||a.call(p,r);return}if(i||!t.current)return;let c;const n={sitekey:d,action:g,cData:S,theme:C,language:x,tabindex:b,"response-field":N,"response-field-name":A,size:_,retry:q,"retry-interval":z,"refresh-expired":y,appearance:ee,execution:M,callback:(r,f)=>{var m,O;(m=p.onVerify)===null||m===void 0||m.call(p,r,c),(O=p.onSuccess)===null||O===void 0||O.call(p,r,f,c)},"error-callback":r=>{var f;return(f=p.onError)===null||f===void 0?void 0:f.call(p,r,c)},"expired-callback":r=>{var f;return(f=p.onExpire)===null||f===void 0?void 0:f.call(p,r,c)},"timeout-callback":()=>{var r;return(r=p.onTimeout)===null||r===void 0?void 0:r.call(p,c)},"after-interactive-callback":()=>{var r;return(r=p.onAfterInteractive)===null||r===void 0?void 0:r.call(p,c)},"before-interactive-callback":()=>{var r;return(r=p.onBeforeInteractive)===null||r===void 0?void 0:r.call(p,c)},"unsupported-callback":()=>{var r;return(r=p.onUnsupported)===null||r===void 0?void 0:r.call(p,c)}};e=window.turnstile.render(t.current,n),c=Ye(e),(l=p.onLoad)===null||l===void 0||l.call(p,e,c)})(),()=>{i=!0,e&&window.turnstile.remove(e)}},[d,g,S,C,x,b,N,A,_,q,z,y,ee,M]),(0,V.useEffect)(()=>{p.onVerify=j,p.onSuccess=U,p.onLoad=G,p.onError=K,p.onExpire=H,p.onTimeout=Q,p.onAfterInteractive=Z,p.onBeforeInteractive=P,p.onUnsupported=J},[j,U,G,K,H,Q,Z,P,J]),V.default.createElement("div",{ref:t,id:o,className:s,style:u})}var Xe=ne.default=Je;function Ye(o){return{execute:s=>window.turnstile.execute(o,s),reset:()=>window.turnstile.reset(o),getResponse:()=>window.turnstile.getResponse(o),isExpired:()=>window.turnstile.isExpired(o)}}function ze(){const[o,s]=(0,V.useState)(F);return(0,V.useEffect)(()=>{F!=="ready"&&Ae.then(()=>s(F))},[]),Y.turnstile}ne.useTurnstile=ze;var Te={};(function(o){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var s=g($),h=["placeholder","separator","isLastChild","ariaLabelOverride","shouldRender","inputStyle","focus","isDisabled","hasErrored","errorStyle","isSuccessed","successStyle","focusStyle","disabledStyle","shouldAutoFocus","isInputNum","index","value","className","isInputSecure","onSubmit"];function d(t){if(typeof WeakMap!="function")return null;var u=new WeakMap,i=new WeakMap;return(d=function(a){return a?i:u})(t)}function g(t,u){if(!u&&t&&t.__esModule)return t;if(t===null||j(t)!=="object"&&typeof t!="function")return{default:t};var i=d(u);if(i&&i.has(t))return i.get(t);var e={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in t)if(l!=="default"&&Object.prototype.hasOwnProperty.call(t,l)){var c=a?Object.getOwnPropertyDescriptor(t,l):null;c&&(c.get||c.set)?Object.defineProperty(e,l,c):e[l]=t[l]}return e.default=t,i&&i.set(t,e),e}function S(){return S=Object.assign?Object.assign.bind():function(t){for(var u=1;u<arguments.length;u++){var i=arguments[u];for(var e in i)Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e])}return t},S.apply(this,arguments)}function C(t,u){if(t==null)return{};var i=x(t,u),e,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)e=l[a],!(u.indexOf(e)>=0)&&Object.prototype.propertyIsEnumerable.call(t,e)&&(i[e]=t[e])}return i}function x(t,u){if(t==null)return{};var i={},e=Object.keys(t),a,l;for(l=0;l<e.length;l++)a=e[l],!(u.indexOf(a)>=0)&&(i[a]=t[a]);return i}function b(t,u){if(!(t instanceof u))throw new TypeError("Cannot call a class as a function")}function N(t,u){for(var i=0;i<u.length;i++){var e=u[i];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}function A(t,u,i){return u&&N(t.prototype,u),i&&N(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function _(t,u){if(typeof u!="function"&&u!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(u&&u.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),u&&W(t,u)}function W(t,u){return W=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,a){return e.__proto__=a,e},W(t,u)}function q(t){var u=ee();return function(){var e=M(t),a;if(u){var l=M(this).constructor;a=Reflect.construct(e,arguments,l)}else a=e.apply(this,arguments);return z(this,a)}}function z(t,u){if(u&&(j(u)==="object"||typeof u=="function"))return u;if(u!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return y(t)}function y(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ee(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function M(t){return M=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},M(t)}function v(t,u,i){return u in t?Object.defineProperty(t,u,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[u]=i,t}function j(t){"@babel/helpers - typeof";return j=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u},j(t)}var U=8,G=37,K=39,H=46,Q=32,Z=13,P=function(u){return j(u)==="object"},J=function(t){_(i,t);var u=q(i);function i(e){var a;return b(this,i),a=u.call(this,e),v(y(a),"getClasses",function(){for(var l=arguments.length,c=new Array(l),n=0;n<l;n++)c[n]=arguments[n];return c.filter(function(r){return!P(r)&&r!==!1}).join(" ")}),v(y(a),"getType",function(){var l=a.props,c=l.isInputSecure,n=l.isInputNum;return c?"password":n?"tel":"text"}),v(y(a),"getAriaLabel",function(l,c){var n=a.props.ariaLabelOverride;return n||"".concat(l===0?"Please enter verification code. ":"").concat(c?"Digit":"Character"," ").concat(l+1)}),a.input=s.default.createRef(),a}return A(i,[{key:"componentDidMount",value:function(){var a=this.props,l=a.focus,c=a.shouldAutoFocus,n=this.input.current;n&&l&&c&&n.focus()}},{key:"componentDidUpdate",value:function(a){var l=this.props.focus,c=this.input.current;a.focus!==l&&c&&l&&(c.focus(),c.select())}},{key:"render",value:function(){var a=this.props,l=a.placeholder,c=a.separator,n=a.isLastChild;a.ariaLabelOverride;var r=a.shouldRender,f=a.inputStyle,m=a.focus,O=a.isDisabled,D=a.hasErrored,I=a.errorStyle,E=a.isSuccessed,k=a.successStyle,L=a.focusStyle,R=a.disabledStyle;a.shouldAutoFocus;var ae=a.isInputNum,oe=a.index,re=a.value,ue=a.className;a.isInputSecure,a.onSubmit;var ie=C(a,h);return s.default.createElement("div",{className:ue,style:{display:"flex",alignItems:"center"}},s.default.createElement("input",S({"aria-label":this.getAriaLabel(oe,ae),style:Object.assign({width:"1em",textAlign:"center",padding:0},P(f)&&f,m&&P(L)&&L,O&&P(R)&&R,D&&!E&&P(I)&&I,E&&!D&&P(k)&&k),placeholder:l,className:this.getClasses(f,m&&L,O&&R,D&&!E&&I,E&&!D&&k),type:this.getType(),ref:this.input,disabled:O,value:re||""},ie)),!n&&r&&c)}}]),i}(s.PureComponent),te=function(t){_(i,t);var u=q(i);function i(){var e;b(this,i);for(var a=arguments.length,l=new Array(a),c=0;c<a;c++)l[c]=arguments[c];return e=u.call.apply(u,[this].concat(l)),v(y(e),"state",{activeInput:0}),v(y(e),"getOtpValue",function(){return e.props.value?e.props.value.toString().split(""):[]}),v(y(e),"getPlaceholderValue",function(){var n=e.props,r=n.placeholder,f=n.numInputs;if(typeof r=="string"){if(r.length===f)return r;r.length>0&&console.error("Length of the placeholder should be equal to the number of inputs.")}}),v(y(e),"handleOtpChange",function(n){var r=e.props.onChange,f=n.join("");r(f)}),v(y(e),"isInputValueValid",function(n){var r=e.props.isInputNum?!isNaN(parseInt(n,10)):typeof n=="string";return r&&n.trim().length===1}),v(y(e),"focusInput",function(n){var r=e.props.numInputs,f=Math.max(Math.min(r-1,n),0);e.setState({activeInput:f})}),v(y(e),"focusNextInput",function(){var n=e.state.activeInput;e.focusInput(n+1)}),v(y(e),"focusPrevInput",function(){var n=e.state.activeInput;e.focusInput(n-1)}),v(y(e),"changeCodeAtFocus",function(n){var r=e.state.activeInput,f=e.getOtpValue();f[r]=n[0],e.handleOtpChange(f)}),v(y(e),"handleOnPaste",function(n){n.preventDefault();var r=e.state.activeInput,f=e.props,m=f.numInputs,O=f.isDisabled;if(!O){for(var D=e.getOtpValue(),I=r,E=n.clipboardData.getData("text/plain"),k=e.props.isInputNum?E.replace(/\D/g,""):E,L=k.slice(0,m-r).split(""),R=0;R<m;++R)R>=r&&L.length>0&&(D[R]=L.shift(),I++);e.setState({activeInput:I},function(){e.focusInput(I),e.handleOtpChange(D)})}}),v(y(e),"handleOnChange",function(n){var r=n.target.value;e.isInputValueValid(r)&&e.changeCodeAtFocus(r)}),v(y(e),"handleOnKeyDown",function(n){n.keyCode===U||n.key==="Backspace"?(n.preventDefault(),e.changeCodeAtFocus(""),e.focusInput(e.state.activeInput-1)):n.keyCode===H||n.key==="Delete"?(n.preventDefault(),e.changeCodeAtFocus("")):n.keyCode===G||n.key==="ArrowLeft"?(n.preventDefault(),e.focusPrevInput()):n.keyCode===K||n.key==="ArrowRight"?(n.preventDefault(),e.focusNextInput()):n.keyCode===Q||n.key===" "||n.key==="Spacebar"||n.key==="Space"?n.preventDefault():(n.keyCode===Z||n.key==="Enter")&&e.props.onSubmit()}),v(y(e),"handleOnInput",function(n){var r=n.target.value;if(n.target.value){if(n.target.value&&n.target.value.length>1){n.preventDefault();for(var f=e.props.numInputs,m=e.state.activeInput,O=e.getOtpValue(),D=n.target.value.slice(0,f-m).split(""),I=0;I<f;++I)I>=m&&D.length>0&&(O[I]=D.shift());e.handleOtpChange(O),e.focusInput(e.props.numInputs)}else if(r&&r.trim().length>1)n.clipboardData={getData:function(){return r.trim()}},e.handleOnPaste(n);else if(e.isInputValueValid(n.target.value))e.focusNextInput();else if(!e.props.isInputNum){var E=n.nativeEvent;E.data===null&&E.inputType==="deleteContentBackward"&&(n.preventDefault(),e.changeCodeAtFocus(""),e.focusPrevInput())}}}),v(y(e),"renderInputs",function(){for(var n=e.state.activeInput,r=e.props,f=r.id,m=r.autoComplete,O=r.numInputs,D=r.inputStyle,I=r.focusStyle,E=r.separator,k=r.separateAfter,L=k===void 0?1:k,R=r.isDisabled,ae=r.disabledStyle,oe=r.hasErrored,re=r.errorStyle,ue=r.isSuccessed,ie=r.successStyle,Re=r.shouldAutoFocus,Ne=r.isInputNum,je=r.isInputSecure,ke=r.className,X=r.inputProps,Le=r.onSubmit,de=[],ve=e.getOtpValue(),he=e.getPlaceholderValue(),ye=e.props["data-cy"],ge=e.props["data-testid"],be=e.props["custom-test-attr"],me=e.props["custom-test-id"],Fe=function(w){var le=void 0;(w+1)%parseInt(L)===0?le=!0:le=!1;var Se={};be&&(Se[be]=me&&"".concat(me,"-").concat(w));var ce={};X&&(Array.isArray(X)?X[w]&&(ce=X[w]):ce=X),de.push(s.default.createElement(J,S({id:f&&"".concat(f,"-").concat(w),autoComplete:m!=null?m:"off",placeholder:he&&he[w],key:w,index:w,focus:n===w,value:ve&&ve[w],onChange:e.handleOnChange,onKeyDown:e.handleOnKeyDown,onInput:e.handleOnInput,onPaste:e.handleOnPaste,onFocus:function(Ve){e.setState({activeInput:w}),Ve.target.select()},onBlur:function(){return e.setState({activeInput:-1})},separator:E,inputStyle:D,focusStyle:I,isLastChild:w===O-1,isDisabled:R,disabledStyle:ae,hasErrored:oe,errorStyle:re,isSuccessed:ue,successStyle:ie,shouldAutoFocus:Re,isInputNum:Ne,isInputSecure:je,className:ke,"data-cy":ye&&"".concat(ye,"-").concat(w),"data-testid":ge&&"".concat(ge,"-").concat(w),shouldRender:le,onSubmit:Le},ce,Se)))},se=0;se<O;se++)Fe(se);return de}),e}return A(i,[{key:"componentDidUpdate",value:function(){var a=this.props.value,l=this.state.activeInput;a==""&&l>0&&this.setState({activeInput:0})}},{key:"render",value:function(){var a=this.props.containerStyle;return s.default.createElement("div",{style:Object.assign({display:"flex"},P(a)&&a),className:P(a)?"":a},this.renderInputs())}}]),i}(s.Component);v(te,"defaultProps",{numInputs:4,onChange:function(u){return console.log(u)},isDisabled:!1,shouldAutoFocus:!1,value:"",isInputSecure:!1,onSubmit:function(u){return console.log(u)}});var p=te;o.default=p})(Te);const it=Be(Te),et=({email:o})=>{const{data:s}=pe(),[h,{isLoading:d}]=De(),{enqueueSnackbar:g}=Ie(),{t:S}=we(),[C,x]=$e.useState(!1),[b,N]=$.useState(0);return $.useEffect(()=>{if(b>0){const A=setTimeout(()=>N(b-1),1e3);return()=>clearTimeout(A)}},[b]),o.split("@")[1],_e(We,{children:[T(Ce,{position:"end",children:T(Ee,{"aria-label":"send email code",onClick:()=>x(!0),edge:"end",color:"secondary",disabled:d||b>0,sx:{backgroundColor:"rgba(51, 102, 255, 0.9)",color:"white","&:hover":{backgroundColor:"rgba(51, 102, 255, 1)"},padding:1.5},children:b>0?"".concat(b,"s"):T(Pe,{})})}),_e(qe,{open:C,onClose:()=>x(!1),children:[T(Ue,{children:T(Ge,{i18nKey:"auth.captcha.title",children:"Captcha"})}),T(Ke,{children:T(Xe,{sitekey:s==null?void 0:s.recaptcha_site_key,onVerify:A=>{h({email:o,recaptcha_data:A}).unwrap().then(()=>{g(S("auth.captcha.success"),{variant:"success"}),Oe.event("send_email_verify",{category:"auth",label:"send_email_verify",email:o,success:!0})}).catch(_=>{console.error(_),g(S("auth.captcha.error"),{variant:"error"}),Oe.event("send_email_verify",{category:"auth",label:"send_email_verify",email:o,success:!1,error:_})}).finally(()=>{x(!1)})},onError:()=>{g(S("auth.captcha.error"),{variant:"error"})}})})]})]})},st=({email:o})=>{const[s,{isLoading:h}]=De(),{data:d}=pe(),{enqueueSnackbar:g}=Ie(),{t:S}=we(),[C,x]=$.useState(0);$.useEffect(()=>{if(C>0){const _=setTimeout(()=>x(C-1),1e3);return()=>clearTimeout(_)}},[C]);const{data:b}=pe(),N=o.split("@")[1],A=()=>{if(b!=null&&b.email_whitelist_suffix&&Array.isArray(b.email_whitelist_suffix)&&!b.email_whitelist_suffix.includes(N)){g(S("auth.captcha.white_email"),{variant:"error"});return}console.log("send email code"),s({email:o}).unwrap().then(()=>{g(S("auth.captcha.success"),{variant:"success"}),x(60)}).catch(_=>{console.error(_),g(S("auth.captcha.error"),{variant:"error"})})};return(d==null?void 0:d.is_recaptcha)===1?T(et,{email:o}):T(Ce,{position:"end",children:T(Ee,{"aria-label":"send email code",onClick:A,edge:"end",color:"secondary",disabled:h||C>0,sx:{backgroundColor:"primary.main",color:"white","&:hover":{backgroundColor:"rgba(51, 102, 255, 0.9)"},padding:1.5},children:C>0?"".concat(C,"s"):T(Pe,{})})})},tt=o=>new RegExp(/[0-9]/).test(o),rt=o=>new RegExp(/[a-z]/).test(o)&&new RegExp(/[A-Z]/).test(o),nt=o=>new RegExp(/[!#@$%^&*)(+=._-]/).test(o),lt=o=>o<2?{label:"Poor",color:"error.main"}:o<3?{label:"Weak",color:"warning.main"}:o<4?{label:"Normal",color:"warning.dark"}:o<5?{label:"Good",color:"success.main"}:o<6?{label:"Strong",color:"success.dark"}:{label:"Poor",color:"error.main"},ct=o=>{let s=0;return o.length>5&&(s+=1),o.length>7&&(s+=1),tt(o)&&(s+=1),nt(o)&&(s+=1),rt(o)&&(s+=1),s};export{it as O,st as S,Xe as _,lt as a,ct as s};
