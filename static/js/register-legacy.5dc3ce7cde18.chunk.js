System.register(["./vendor-legacy.92ff5d757b54.chunk.js","./AuthWrapper-legacy.053921947c95.chunk.js","./password-strength-legacy.2ee46ee1daff.chunk.js","./formik.esm-legacy.38ad42bcc0d2.chunk.js","./index-legacy.104de674e3dc.js","./AnimateButton-legacy.7aa0a2a09c0d.chunk.js","./useQuery-legacy.58516b67f19b.chunk.js","./hey-listen.es-legacy.2cf185e905fe.chunk.js"],(function(e,i){"use strict";var r,t,n,a,o,s,l,c,d,m,h,u,p,g,_,w,f,v,b,y,x,S,C,q,k,j,B,I,A,W,F,P,E,z,D,K,M,V,$,O,R,T,H,Q,G,J,L,N,U,X;return{setters:[e=>{r=e.r,t=e.h,n=e.b9,a=e.aa,o=e.n,s=e.a9,l=e.i,c=e.F,d=e.j,m=e.B,h=e.aI,u=e.ah,p=e.ba,g=e.an,_=e.bb,w=e.bc,f=e.bd,v=e.be,b=e.bf,y=e.bi,x=e.T,S=e.l,C=e.bj,q=e.bk,k=e.bg,j=e.m,B=e.bh,I=e.ao,A=e.bl,W=e.bm,F=e.bn,P=e.a$,E=e.bo},e=>{z=e.A},e=>{D=e.S,K=e.O,M=e._,V=e.s,$=e.a},e=>{O=e.c,R=e.a,T=e.b,H=e.d,Q=e.F},e=>{G=e.c,J=e.d,L=e.I,N=e.b},e=>{U=e.A},e=>{X=e.u},null],execute:function(){const i=()=>{r.useState(!1);const e=t(),i=n(),E=a(),{t:z}=o("common"),{enqueueSnackbar:N}=s(),Y=X(),[Z]=G(),{data:ee}=J(),[ie,re]=r.useState(),[te,ne]=r.useState(!1),ae=()=>{ne(!te)},oe=e=>{e.preventDefault()},se=e=>{const i=V(e);re($(i))};r.useEffect((()=>{se("")}),[]);const[le,ce]=r.useState(!1),[de,me]=r.useState(null),[he,ue]=r.useState(null),pe=r.useMemo((()=>O().shape({email:R().email(z("register.email_invalid").toString()).max(255,z("register.email_max",{count:255}).toString()).required(z("register.email_required").toString()),password:R().min(8,z("register.password_min",{count:8}).toString()).max(255,z("register.password_max",{count:255}).toString()).required(z("register.password_required").toString()),password_confirm:R().oneOf([T("password"),null],z("register.password_confirm_invalid").toString()).required(z("register.password_confirm_required").toString()),invite_code:ee?.is_invite_force?R().required(z("register.invite_code_required").toString()):R().max(8,z("register.invite_code_max").toString()),email_code:ee?.is_email_verify?H().required(z("register.email_code_required").toString()):H().negative()})),[z,ee?.is_invite_force,ee?.is_email_verify]),ge=null!=ee?.email_whitelist_suffix&&0!=ee?.email_whitelist_suffix,_e=async(e,r)=>{try{await Z({...e,recaptcha_data:r}).unwrap().then((()=>{N(z("notice::register_success"),{variant:"success"}),E("/dashboard",{replace:!0}),P.event("register",{category:"auth",label:"register",method:"email",success:!0,email:e.email,password_strength:ie?.label,invite_code:e.invite_code})})).catch((r=>{i.current&&(ue(null),N(r.message,{variant:"error"}),P.event("register",{category:"auth",label:"register",method:"email",success:!1,error:r.message,email:e.email,values:e}))}))}catch(t){console.error(t),i.current&&(ue(null),N(z("notice::register_failed"),{variant:"error"}))}};return l(c,{children:[d(Q,{initialValues:{email:"",password:"",password_confirm:"",invite_code:Y.get("code")??"",email_code:"",agree:!1,submit:null},validationSchema:pe,onSubmit:async(e,{setErrors:i,setStatus:r,setSubmitting:t})=>{if(!e.agree)return r({success:!1}),i({submit:z("register.agree_required").toString()}),void t(!1);1===ee?.is_recaptcha?(ue({email:e.email,password:e.password,invite_code:e.invite_code,email_code:ee?.is_email_verify?e.email_code:""}),ce(!0),t(!1)):(_e({email:e.email,password:e.password,invite_code:e.invite_code,email_code:ee?.is_email_verify?e.email_code:""},""),t(!1))},children:({errors:i,handleBlur:r,handleChange:t,handleSubmit:n,isSubmitting:a,touched:o,values:s,setValues:A})=>d(m,{component:"form",onSubmit:n,children:l(h,{container:!0,spacing:3,children:[d(h,{item:!0,xs:12,children:l(u,{spacing:1,children:[d(p,{htmlFor:"email",children:d(g,{children:"register.email"})}),d(_,{fullWidth:!0,error:Boolean(o.email&&i.email),id:"email",type:"email",value:s.email,name:"email",onBlur:r,onChange:t,placeholder:"user@example.com",inputProps:{},endAdornment:1===ee?.is_email_verify?d(D,{email:s.email}):void 0}),ge&&l(w,{error:!0,id:"helper-text-email-signup",children:["仅支持",Array.isArray(ee?.email_whitelist_suffix)?ee.email_whitelist_suffix.join(", "):ee?.email_whitelist_suffix,"注册"]}),o.email&&i.email&&d(w,{error:!0,id:"helper-text-email-signup",children:i.email})]})}),1===ee?.is_email_verify&&d(c,{children:d(h,{item:!0,xs:12,children:l(u,{spacing:1,children:[d(p,{htmlFor:"email-code-signup",children:d(g,{children:"register.email_code"})}),d(K,{value:s.email_code,onChange:e=>{A((i=>({...i,email_code:e})))},numInputs:6,containerStyle:{justifyContent:"space-between"},inputStyle:{width:"100%",margin:"8px",padding:"10px",border:`1px solid ${"dark"===e.palette.mode?e.palette.grey[200]:e.palette.grey[300]}`,borderRadius:4,":hover":{borderColor:e.palette.primary.main}},focusStyle:{outline:"none",boxShadow:e.customShadows.primary,border:`1px solid ${e.palette.primary.main}`}}),o.email_code&&i.email_code&&d(w,{error:!0,id:"helper-text-email-signup",children:i.email_code})]})})}),l(h,{item:!0,xs:12,children:[l(u,{spacing:1,children:[d(p,{htmlFor:"password-signup",children:d(g,{children:"register.password"})}),d(_,{fullWidth:!0,error:Boolean(o.password&&i.password),id:"password-signup",type:te?"text":"password",value:s.password,name:"password",onBlur:r,onChange:e=>{t(e),se(e.target.value)},autoComplete:"new-password",endAdornment:d(f,{position:"end",children:d(L,{"aria-label":"toggle password visibility",onClick:ae,onMouseDown:oe,edge:"end",color:"secondary",children:d(te?v:b,{})})}),placeholder:"******",inputProps:{}}),o.password&&i.password&&d(w,{error:!0,id:"helper-text-password-signup",children:i.password})]}),d(y,{fullWidth:!0,sx:{mt:2},children:l(h,{container:!0,spacing:2,alignItems:"center",children:[d(h,{item:!0,children:d(m,{sx:{bgcolor:ie?.color,width:85,height:8,borderRadius:"7px"}})}),d(h,{item:!0,children:d(x,{variant:"subtitle1",fontSize:"0.75rem",children:z("register.password_strength",{context:S.lowerCase(ie?.label)}).toString()})})]})})]}),d(h,{item:!0,xs:12,children:l(u,{spacing:1,children:[d(p,{htmlFor:"password-confirm",children:d(g,{children:"register.password_confirm"})}),d(_,{fullWidth:!0,error:Boolean(o.password_confirm&&i.password_confirm),id:"password-confirm",type:te?"text":"password",value:s.password_confirm,name:"password_confirm",onBlur:r,onChange:e=>{t(e),se(e.target.value)},autoComplete:"new-password",placeholder:"******",inputProps:{}}),o.password_confirm&&i.password_confirm&&d(w,{error:!0,id:"helper-text-password-confirm",children:i.password_confirm})]})}),d(h,{item:!0,xs:12,children:l(u,{spacing:1,children:[d(p,{htmlFor:"invite-code-signup",required:1===ee?.is_invite_force,children:d(g,{children:"register.invite_code"})}),d(_,{fullWidth:!0,error:Boolean(o.invite_code&&i.invite_code),id:"invite-code-signup",type:"text",value:s.invite_code,name:"invite_code",onBlur:r,onChange:t,required:1===ee?.is_invite_force,placeholder:z("register.invite_code_placeholder",{context:1===ee?.is_invite_force?"required":"optional"}).toString(),inputProps:{},disabled:null!==Y.get("code")}),o.invite_code&&i.invite_code&&d(w,{error:!0,id:"helper-text-email-signup",children:i.invite_code})]})}),d(h,{item:!0,xs:12,children:d(C,{value:!1,control:d(q,{}),name:"agree",id:"agree",onBlur:r,onChange:t,"aria-required":!0,sx:{alignItems:"flex-start"},label:d(x,{variant:"body2",sx:{lineHeight:2.9},children:l(g,{i18nKey:"register.license_agree",children:[d(k,{id:"terms-of-service",variant:"subtitle2",component:j,to:"服务协议链接"}),d(k,{id:"privacy-policy",variant:"subtitle2",component:j,to:"隐私协议链接"})]})})})}),d(h,{item:!0,xs:12,children:d(U,{children:d(B,{disableElevation:!0,disabled:a,fullWidth:!0,size:"large",type:"submit",variant:"contained",color:"primary",children:a?d(I,{size:24,color:"inherit"}):d(g,{children:"register.submit"})})})})]})})}),1===ee?.is_recaptcha&&l(A,{open:le,onClose:()=>ce(!1),children:[d(W,{children:d(g,{i18nKey:"auth.captcha.title",children:"Captcha"})}),d(F,{children:d(M,{sitekey:ee?.recaptcha_site_key,onVerify:e=>{me(e),ce(!1),he&&(_e(he,e),ue(null))},onError:()=>{N(z("auth.captcha.error"),{variant:"error"}),ce(!1)}})})]})]})};e("default",(()=>{N("register");const[e,t]=r.useState(!0),n=()=>{t(!1)};return l(z,{children:[l(A,{open:e,onClose:n,disableEscapeKeyDown:!0,children:[l(W,{children:[window.config?.title,"购前注意与服务条款"]}),l(F,{children:[l(x,{variant:"body1",paragraph:!0,children:[window.config?.title,"提供的服务允许用户在 Internet 上建立安全的连接。我们的目的是提高您的在线隐私和安全，但我们不能保证完全的匿名性。"]}),l(x,{variant:"body1",paragraph:!0,children:[d("strong",{children:"禁止非法行为："})," 使用",window.config?.title,"的服务从事任何违法活动，包括但不限于 BT 下载、挖矿、邪教、诈骗、发送 SPAM 邮件等都是严格禁止的。",d("br",{}),d("strong",{children:"禁止讨论政治："})," 严禁使用",window.config?.title,"的服务讨论、传播或以任何形式参与政治相关的活动或话题，请相关人士请绕道。",d("br",{}),d("br",{}),d("strong",{children:"订阅链接、节点域名和 IP："})," 用户严禁泄露、分享或以任何方式发布与",window.config?.title,"服务相关的订阅链接、节点域名或节点 IP 等信息。仅限个人使用，禁止共享给他人使用。"]})]}),d(E,{children:d(B,{onClick:n,color:"primary",children:"我已阅读并同意"})})]}),l(h,{container:!0,spacing:3,children:[l(h,{item:!0,xs:12,container:!0,justifyContent:"center",alignItems:"center",children:[l(x,{color:"red",fontSize:"25px",children:["永久官网: ",window.config?.officialWebsite]}),l(x,{children:["当前可用: ",window.config?.website]})]}),d(h,{item:!0,xs:12,children:l(u,{direction:"row",justifyContent:"space-between",alignItems:"baseline",sx:{mb:{xs:-.5,sm:.5}},children:[d(x,{variant:"h3",children:d(g,{children:"register.title"})}),d(x,{component:j,to:"/login",variant:"body1",sx:{textDecoration:"none"},color:"primary",children:d(g,{children:"register.go-login"})})]})}),d(h,{item:!0,xs:12,children:d(i,{})})]})]})}))}}}));
